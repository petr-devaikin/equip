<ion-view view-title="">
  <ion-content>
    <div ng-show="askForLocation" class="padding" style="background: #fff; border-bottom: 1px solid #ccc; padding-bottom: 20px; padding-top: 0;">
      <div ng-show="lastLocation !== undefined">
        <button class="button button-positive" ng-click="confirmLocation()" style="border: 1px solid rgb(211, 211, 211); text-align: left; border-radius: 0; float: right; position: relative; height: 30px; width: 80px; text-align: center;">Yes</button>
        <h4 style="padding-top: 15px; margin-bottom: 20px;">
          Are you still at {{lastLocation.attributes.name}}?
        </h4>

        <label class="item item-input item-select">
          <div class="input-label">
            NO, I'm currently at
          </div>
          <select ng-options="loc as loc.attributes.name for loc in locations" ng-model="newLocation" ng-change="updateLocation(newLocation)"></select>
        </label>
      </div>

      <div ng-show="lastLocation === undefined">
        <h4 style="padding-top: 15px; margin-bottom: 20px;">
          Choose your location
        </h4>
        <label class="item item-input item-select">
          <div class="input-label">
            I'm currently at
          </div>
          <select ng-options="loc as loc.attributes.name for loc in locations" ng-model="newLocation" ng-change="updateLocation(newLocation)"></select>
        </label>
      </div>
    </div>

    <div ng-show="!askForLocation" class="padding your-location">
      Your location: <strong>{{lastLocation.attributes.name}}</strong>
      <i class="icon ion-pinpoint" style="color: #000; margin-left: 5px;"></i>
    </div>

    <button class="button" ng-show="!newCoversationInProgress" style="border-radius: 52px; height: 52px; position: relative; left: 50%; margin-left: -107px; z-index: 100; background: #3b3b3b; color: #fff;"  ng-mouseup="stopConversation()" ng-mousedown="startConversation()">
      START CONVERSATION
    </button>
    <div ng-show="newCoversationInProgress" class="card">
      <div class="item item-divider">
        Creating New Conversation
      </div>
      <div class="item">
        Message info here
      </div>
      <div class="item">
        <label class="item item-input item-select">
          <div class="input-label">
            I'm currently at
          </div>
          <select ng-options="loc as loc.attributes.name for loc in locations" ng-model="newLocation"></select>
        </label>
        Send a message to
        <label class="item item-input item-select">
          <ion-list>
            <ion-radio ng-model="choice" ng-value="dest" ng-repeat="dest in destinations" ng-style="dest.featured ? { 'font-weight': 'bold' } : { 'font-weight': 'normal' }">
              <span ng-show="dest.entity.className == 'Group'">GROUP:</span>
              <span ng-show="dest.entity.className == 'Location'">LOCATION:</span>
              {{ dest.name }}
            </ion-radio>
          </ion-list>
          <select ng-options="dest as dest.attributes.name for dest in destinations" ng-model="convoDestination"></select>
        </label>
      </div>
      <div class="item item-divider" ng-click="sendConversation(newLocation, convoDestination)">
        <button class="button button-balanced">
          Send!
        </button>
      </div>
    </div>

    <div class="card" ng-repeat="convo in conversations">
      <div ng-show="convo.conversation.attributes.toGroup" class="item item-divider">
        GROUP: {{ convo.attributes.toGroup.attributes.name }}
      </div>
      <div ng-show="convo.conversation.attributes.toLocation" class="item item-divider">
        <i class="icon ion-location"></i> {{ convo.conversation.attributes.toLocation.attributes.name }}
      </div>
      <div ng-show="convo.conversation.attributes.toLocation === undefined && convo.conversation.attributes.toGroup === undefined" class="item item-divider" style="background: #beeced;">
        ALL (BROADCAST)
        <!--span style="float: right;">1 NEW MESSAGE</span-->
      </div>

      <div class="item item-text-wrap item-icon-left">
        Started by
        <span style="font-weight: bold; text-transform: uppercase;">{{ convo.conversation.attributes.startedBy.attributes.username }}</span>
        from
        <span style="font-weight: bold; text-transform: uppercase;">{{ convo.conversation.attributes.fromLocation.attributes.name }}</span>
        at
        <span style="font-weight: bold; text-transform: uppercase;">
          {{ convo.conversation.attributes.createdAt.getUTCHours() + ":" + convo.conversation.attributes.createdAt.getUTCMinutes(); }}
        </span>

        <button class="button" style="border-radius: 31px; height: 32px; position: relative; float: right; background: #3b3b3b; color: #fff;"  ng-mouseup="stopReply(convo.conversation)" ng-mousedown="startReply(convo.conversation)">
          Reply
        </button>
      </div>

      Messages:
      <a href="#" class="item item-icon-left" ng-repeat="message in convo.messages">
        <i class="icon ion-play" ng-click="playMessage(message)" ></i>
        Message from
        <span style="font-weight: bold; text-transform: uppercase;">{{ message.attributes.fromUser.attributes.username }}</span>
        from
        <span style="font-weight: bold; text-transform: uppercase;">{{ message.attributes.fromLocation.attributes.name }}</span>
        at
        <span style="font-weight: bold; text-transform: uppercase;">
          {{ message.attributes.createdAt.getUTCHours() + ":" + message.attributes.createdAt.getUTCMinutes(); }}
        </span>
      </a>
    </div>

    <!--div class="card" ng-repeat="message in messages">
      <div ng-show="message.attributes.toGroup" class="item item-divider">
        GROUP: {{ message.attributes.toGroup.attributes.name }}
      </div>
      <div ng-show="message.attributes.toLocation" class="item item-divider">
        <i class="icon ion-location"></i> {{ message.attributes.toLocation.attributes.name }}
      </div>
      <div ng-show="message.attributes.toLocation === undefined && message.attributes.toGroup === undefined" class="item item-divider" style="background: #beeced;">
        ALL (BROADCAST)
        <span style="float: right;">1 NEW MESSAGE</span>
      </div>

      <div class="item item-text-wrap item-icon-left">
        <i class="icon ion-play" ng-click="playMessage(message)" ></i>
        <span style="font-weight: bold; text-transform: uppercase;">{{ message.attributes.fromUser.attributes.username }}</span>
        from
        <span style="font-weight: bold; text-transform: uppercase;">STAGE</span>
        at
        <span style="font-weight: bold; text-transform: uppercase;">
          {{ message.attributes.createdAt.getUTCHours() + ":" + message.attributes.createdAt.getUTCMinutes(); }}
        </span>
      </div>
    </div-->
  </ion-content>
</ion-view>
